# Reusing Logic with Custom Hooks

- `React`ëŠ” `useState`, `useContext`, `useEffect`ì™€ ê°™ì€ ë‚´ì¥ `Hook`ì´ í•¨ê»˜ ì œê³µë©ë‹ˆë‹¤.
- ë•Œë•Œë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜, ì˜¨ë¼ì¸ ì—¬ë¶€ë¥¼ ì¶”ì í•˜ê±°ë‚˜, ì±„íŒ…ë°©ì— ì—°ê²°í•˜ëŠ” ë“±ì˜ íŠ¹ì • ëª©ì ì„ ìœ„í•œ `Hook`ì´ ìˆìœ¼ë©´ ë” ì¢‹ì„ ê²ë‹ˆë‹¤.
- `React`ì—ì„œ ì´ëŸ¬í•œ `Hook`ì„ ì°¾ì§€ ëª»í•  ìˆ˜ë„ ìˆì§€ë§Œ, í•„ìš”í•œ `Hook`ì„ ë§Œë“¤ë©´ ë©ë‹ˆë‹¤.

<br>

## ë°°ìš°ê²Œ ë  ê²ƒ

- ì»¤ìŠ¤í…€ `Hook`ì´ ë¬´ì—‡ì¸ì§€, ì»¤ìŠ¤í…€ `Hook`ì„ ì‘ì„±í•˜ëŠ” ë°©ë²•
- ì»´í¬ë„ŒíŠ¸ ê°„ ë¡œì§ ì¬ì‚¬ìš© ë°©ë²•
- ì»¤ìŠ¤í…€ `Hook`ì˜ ì´ë¦„ê³¼ êµ¬ì¡°ë¥¼ ì‘ì„±í•˜ëŠ” ë°©ë²•
- ì»¤ìŠ¤í…€ `Hook`ì„ ì¶”ì¶œí•´ì•¼ í•  ë•Œì™€ ë°©ë²•

<br>

## ì»¤ìŠ¤í…€ Hook: ì»´í¬ë„ŒíŠ¸ ê°„ ë¡œì§ ê³µìœ í•˜ê¸°

- ëŒ€ë¶€ë¶„ì˜ ì•±ì´ ê·¸ë ‡ë“¯ì´ ë„¤íŠ¸ì›Œí¬ì— í¬ê²Œ ì˜ì¡´í•˜ëŠ” ì•±ì„ ê°œë°œí•œë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.
- ìœ ì €ê°€ ì•±ì„ ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ëŠì–´ì¡Œì„ ê²½ìš° ê²½ê³  ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤.
- ì–´ë–»ê²Œ í•  ê±´ê°€ìš”?

<br>

- ì»´í¬ë„ŒíŠ¸ì—ëŠ” ì•„ë˜ 2ê°€ì§€ê°€ í•„ìš”í•©ë‹ˆë‹¤.

1. ë„¤íŠ¸ì›Œí¬ì˜ ì˜¨ë¼ì¸ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ìƒíƒœ
2. ì „ì—­ ì˜¨ë¼ì¸, ì˜¤í”„ë¼ì¸ ì´ë²¤íŠ¸ë¥¼ êµ¬ë…í•˜ì—¬ í•´ë‹¹ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” `Effect`

<br>

- ì´ëŠ” ë„¤íŠ¸ì›Œí¬ ìƒíƒœì™€ ì»´í¬ë„ŒíŠ¸ì˜ ë™ê¸°í™”ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.

```js
import { useState, useEffect } from 'react';

export default function StatusBar() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    function handleOnline() {
      setIsOnline(true);
    }
    function handleOffline() {
      setIsOnline(false);
    }
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}
```

<br>

- ë„¤íŠ¸ì›Œí¬ë¥¼ ì¼°ë‹¤ êº¼ë³´ë©´ì„œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì— ë”°ë¼ ìƒíƒœ í‘œì‹œì¤„ì´ ì–´ë–»ê²Œ ì—…ë°ì´íŠ¸ë˜ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.

<br>

- ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì—ì„œë„ ë™ì¼í•œ ë¡œì§ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?
- ë¹„í™œì„±í™”ë  `Save` ë²„íŠ¼ì„ êµ¬í˜„í•˜ê³ , ë„¤íŠ¸ì›Œí¬ê°€ êº¼ì ¸ìˆëŠ” ë™ì•ˆ `Reconnecting`ì„ í‘œì‹œí•©ë‹ˆë‹¤.

<br>

- ì‹œì‘í•˜ê¸° ìœ„í•´ì„œ `isOnline` ìƒíƒœì™€ `Effect`ë¥¼ `SaveButton`ë¡œ ì˜®ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
import { useState, useEffect } from 'react';

export default function SaveButton() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    function handleOnline() {
      setIsOnline(true);
    }
    function handleOffline() {
      setIsOnline(false);
    }
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}
```

<br>

- ë„¤íŠ¸ì›Œí¬ë¥¼ ê»ì„ ë•Œ ë²„íŠ¼ì´ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

<br>

- ìœ„ 2ê°œ ì»´í¬ë„ŒíŠ¸ëŠ” ì˜ ë™ì‘í•˜ì§€ë§Œ, ì¤‘ë³µëœ ë¡œì§ì´ ì¡´ì¬í•©ë‹ˆë‹¤.
- ì‹œê°ì ìœ¼ë¡œ ë‹¤ë¥¸ ëª¨ìŠµì„ í•˜ê³  ìˆì§€ë§Œ, ë¡œì§ì€ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

## ì»´í¬ë„ŒíŠ¸ì—ì„œ ì»¤ìŠ¤í…€ Hook ì¶”ì¶œ

- `useState`, `useEffect`ì™€ ìœ ì‚¬í•˜ê²Œ `useOnlineStatusHook`ì´ ë‚´ì¥ë˜ì–´ ìˆë‹¤ê³  ìƒìƒí•´ë³¼ê¹Œìš”?
- ì•„ë˜ 2ê°œì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¨ìˆœí™”í•˜ì—¬ ì¤‘ë³µì„ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function StatusBar() {
  const isOnline = useOnlineStatus();
  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}

function SaveButton() {
  const isOnline = useOnlineStatus();

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}
```

<br>

- ì´ë ‡ê²Œ ë‚´ì¥ëœ `Hook`ì´ ì¡´ì¬í•˜ì§„ ì•Šì§€ë§Œ, ì§ì ‘ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
- `useOnlineStatus`ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì„ ì–¸í•˜ê³  ì „ì— ì‘ì„±ëœ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì´ë™ì‹œí‚µë‹ˆë‹¤.

```js
function useOnlineStatus() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    function handleOnline() {
      setIsOnline(true);
    }
    function handleOffline() {
      setIsOnline(false);
    }
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);
  return isOnline;
}
```

<br>

- í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ì—ì„œ `isOnline`ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
- ì´ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ì´ ê°’ì˜ ì°¸ì¡°ë¥¼ í—ˆë½í•©ë‹ˆë‹¤.

```js
// App.js
import { useOnlineStatus } from './useOnlineStatus.js';

function StatusBar() {
  const isOnline = useOnlineStatus();
  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}

function SaveButton() {
  const isOnline = useOnlineStatus();

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}

export default function App() {
  return (
    <>
      <SaveButton />
      <StatusBar />
    </>
  );
}
```

```js
// useOnlineStatus.js
import { useOnlineStatus } from './useOnlineStatus.js';

function StatusBar() {
  const isOnline = useOnlineStatus();
  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}

function SaveButton() {
  const isOnline = useOnlineStatus();

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}

export default function App() {
  return (
    <>
      <SaveButton />
      <StatusBar />
    </>
  );
}
```

<br>

- ë„¤íŠ¸ì›Œí¬ë¥¼ ì¼œê±°ë‚˜ ëŒ ë•Œ ì»´í¬ë„ŒíŠ¸ê°€ ì—…ë°ì´íŠ¸ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

<br>

- ì´ì œ ì»´í¬ë„ŒíŠ¸ëŠ” ì¤‘ë³µ ë¡œì§ì„ ê°–ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.
- **ë” ì¤‘ìš”í•œ ì‚¬ì‹¤ì€ ë¸Œë¼ìš°ì € ì´ë²¤íŠ¸ì— ì¶”ê°€ë˜ì–´ ìˆ˜í–‰ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì˜¨ë¼ì¸ ìƒíƒœë¥¼ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì— ëŒ€í•œ ì½”ë“œê°€ ë˜ì—ˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.**

<br>

- ì»¤ìŠ¤í…€ `Hook`ì„ ë¡œì§ì—ì„œ ì¶”ì¶œí•  ë•Œ, ì™¸ë¶€ ì‹œìŠ¤í…œ í˜¹ì€ ë¸Œë¼ìš°ì € APIë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²•ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¨ìˆœí•œ ì½”ë“œê°€ ì•„ë‹ˆë¼, ì‚¬ìš©ìì˜ ì˜ë„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.

<br>

## Hookì˜ ì´ë¦„ì€ í•­ìƒ useë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.

- `React` ì•±ì€ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.
- ë¹ŒíŠ¸ì¸ ì»´í¬ë„ŒíŠ¸ë“  ì»¤ìŠ¤í…€ ì»´í¬ë„ŒíŠ¸ë“  `Hook`ì„ í†µí•´ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤.
- ë‹¤ë¥¸ ì‚¬ëŒì´ ë§Œë“  ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•˜ì§€ë§Œ, ì§ì ‘ ì‘ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

<br>

- ì•„ë˜ì˜ ë„¤ì´ë° ì»¨ë²¤ì…˜ì„ ì§€ì¼œì•¼ í•©ë‹ˆë‹¤.

1. `StatusBar`, `SaveButton`ê³¼ ê°™ì´ `React` ì»´í¬ë„ŒíŠ¸ ì´ë¦„ì€ ëŒ€ë¬¸ìë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.
   - `React` ì»´í¬ë„ŒíŠ¸ëŠ” `JSX`ì™€ ê°™ì´ í™”ë©´ì— í‘œì‹œí•  ë¬´ì–¸ê°€ë¥¼ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.
2. `useOnlineStatus`, `useState`ì™€ ê°™ì´ `Hook`ì˜ ì´ë¦„ì€ `use`ë¡œ ì‹œì‘ë˜ì–´ì•¼ í•˜ê³ , ë°”ë¡œ ë’¤ì— ëŒ€ë¬¸ìê°€ ë”°ë¼ë¶™ì–´ì•¼ í•©ë‹ˆë‹¤.
   - `Hook`ì€ ì¶”ìƒì ì¸ ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

<br>

- ì´ëŸ¬í•œ ì»¨ë²¤ì…˜ì€ ì»´í¬ë„ŒíŠ¸ ìƒíƒœë¥¼ í•­ìƒ í™•ì¸í•  ìˆ˜ ìˆê³  `Effect`ì™€ **ìˆ¨ê²¨ì ¸** ìˆëŠ” `React` ê¸°ëŠ¥ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ `getColor` í•¨ìˆ˜ í˜¸ì¶œì„ í™•ì¸í•œë‹¤ë©´, `use`ë¡œ ì‹œì‘ë˜ëŠ” ì´ë¦„ì´ ì•„ë‹ˆê¸°ì— `React`ì˜ ìƒíƒœë¥¼ í¬í•¨í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ `useOnlineStatus`ì™€ ê°™ì€ í•¨ìˆ˜ëŠ” ë‚´ë¶€ì— ë‹¤ë¥¸ `Hook` í˜¸ì¶œì´ í¬í•¨ë  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

<br>

## ì£¼ì˜

- ë§Œì•½ ë¦°í„°ê°€ ë°˜ì‘í•˜ë„ë¡ ë˜ì–´ ìˆë‹¤ë©´, ì•„ë˜ì˜ ëª…ëª… ê·œì¹™ì„ ì ìš©í•  ê²ë‹ˆë‹¤.
- ìœ„ì˜ ì½”ë“œë¡œ ìŠ¤í¬ë¡¤í•˜ì—¬ `useOnlineStatus` ì´ë¦„ì„ `getOnlineStatus`ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
- ë¦°í„°ëŠ” ë”ì´ìƒ `useState`ë¥¼ í˜¸ì¶œí•˜ê±°ë‚˜ `Effect`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- ì˜¤ì§ `Hook`ê³¼ ì»´í¬ë„ŒíŠ¸ë§Œ ë‹¤ë¥¸ `Hook`ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

## Deep Dive - ë Œë”ë§ ì¤‘ì— í˜¸ì¶œë˜ëŠ” ëª¨ë“  ê¸°ëŠ¥ì€ use ì ‘ë‘ì‚¬ë¡œ ì‹œì‘í•´ì•¼ í• ê¹Œìš”?

- ì•„ë‹™ë‹ˆë‹¤.
- `Hook`ì´ë¼ê³  ë¶€ë¥´ì§€ ì•ŠëŠ” í•¨ìˆ˜ëŠ” `Hook`ì¼ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

<br>

- ë§Œì•½ í•¨ìˆ˜ê°€ `Hook`ì„ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ `use` ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.
- ì ‘ë‘ì‚¬ê°€ ì—†ëŠ” ì¼ë°˜ í•¨ìˆ˜ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
- ì•„ë˜ì˜ `useSorted`ëŠ” `Hook`ì„ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ `getSorted`ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.

```js
// ğŸ”´ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: useë¡œ ì‹œì‘í•˜ëŠ” Hookì¼ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
function useSorted(items) {
  return items.slice().sort();
}

// âœ… êµ¿: Hookì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì •ê·œ í•¨ìˆ˜ì…ë‹ˆë‹¤.
function getSorted(items) {
  return items.slice().sort();
}
```

<br>

- ì´ë ‡ê²Œ í•˜ë©´ ì½”ë“œê°€ ë‹¤ìŒ ì¡°ê±´ì„ í¬í•¨í•˜ì—¬ ì–´ë””ì„œë‚˜ ì´ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function List({ items, shouldSort }) {
  let displayedItems = items;
  if (shouldSort) {
    // âœ… Hookì´ ì•„ë‹ˆë¯€ë¡œ ì¡°ê±´ì— ë”°ë¼ getStoredë¥¼ í˜¸ì¶œí•´ë„ ê´œì°®ìŠµë‹ˆë‹¤.
    displayedItems = getSorted(items);
  }
  // ...
}
```

<br>

- í•¨ìˆ˜ ë‚´ë¶€ì— 1ê°œ ì´ìƒì˜ `Hook`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í•¨ìˆ˜ì— `use` ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```js
// âœ… êµ¿: ë‹¤ë¥¸ Hookì„ ì‚¬ìš©í•˜ëŠ” Hookì…ë‹ˆë‹¤.
function useAuth() {
  return useContext(Auth);
}
```

<br>

- ê¸°ìˆ ì ì¸ ê´€ì ì—ì„œ ë³´ìë©´ `React`ì— ì˜í•´ ê°•ì œë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.
- ì›ì¹™ì ìœ¼ë¡œ ë‹¤ë¥¸ `Hook`ì„ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ” `Hook`ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ëŠ” ë³´í†µ í˜¼ë€ì„ ìœ ë°œí•˜ê³  ì œí•œì ì´ê¸°ì— ì´ëŸ¬í•œ íŒ¨í„´ì„ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ ì´ê²ƒì´ ë„ì›€ì´ ë˜ëŠ” ê²½ìš°ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ì§€ê¸ˆì€ `Hook`ì„ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ ë‚˜ì¤‘ì— `Hook`ì„ í˜¸ì¶œí•  ê³„íšì¸ ê²½ìš°ì…ë‹ˆë‹¤.
- ê·¸ë ‡ë‹¤ë©´ `use` ì ‘ë‘ì‚¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```js
// âœ… êµ¿: ë‚˜ì¤‘ì— ë‹¤ë¥¸ Hookì„ ì‚¬ìš©í• ì§€ë„ ëª¨ë¥´ëŠ” Hook
function useAuth() {
  // TODO: ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆì„ ë•Œ ì´ ì½”ë“œë¥¼ ë³€ê²½í•©ë‹ˆë‹¤.
  // return useContext(Auth);
  return TEST_USER;
}
```

<br>

- ê·¸ëŸ¬ë©´ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì¡°ê±´ë¶€ë¡œ í˜¸ì¶œí•  ìˆ˜ ì—†ê²Œ ë©ë‹ˆë‹¤.
- ì´ëŠ” ì‹¤ì œë¡œ `Hook` í˜¸ì¶œì„ ë‚´ë¶€ì— ì¶”ê°€í•  ë•Œ ì¤‘ìš”í•´ì§‘ë‹ˆë‹¤.
- í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ `Hook`ì„ ì‚¬ìš©í•  ê³„íšì´ ì—†ë‹¤ë©´ `Hook`ìœ¼ë¡œ ë§Œë“¤ë©´ ì•ˆ ë©ë‹ˆë‹¤.

<br>

## ì»¤ìŠ¤í…€ í›…ì€ ìƒíƒœ ìì²´ê°€ ì•„ë‹Œ ìƒíƒœ ì €ì¥ ë¡œì§ì„ ê³µìœ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

- ì•ì„  ì˜ˆì œì—ì„œ ë„¤íŠ¸ì›Œí¬ë¥¼ ì¼œê³  ëŒ ë•Œ 2ê°œ ì»´í¬ë„ŒíŠ¸ê°€ í•¨ê»˜ ì—…ë°ì´íŠ¸ ë˜ì—ˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ `isOnline` ìƒíƒœ ë³€ìˆ˜ê°€ ê³µìœ ë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.

```js
function StatusBar() {
  const isOnline = useOnlineStatus();
  // ...
}

function SaveButton() {
  const isOnline = useOnlineStatus();
  // ...
}
```

<br>

- ì¤‘ë³µì„ ì¶”ì¶œí•˜ê¸° ì „ê³¼ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

```js
function StatusBar() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    // ...
  }, []);
  // ...
}

function SaveButton() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    // ...
  }, []);
  // ...
}
```

<br>

- ì´ëŠ” ì™„ì „íˆ ë¶„ë¦¬ëœ ìƒíƒœ ë³€ìˆ˜ì™€ `Effect`ì…ë‹ˆë‹¤.
- ìœ ì €ê°€ ë™ì¼í•œ ì™¸ë¶€ ê°’ìœ¼ë¡œ ë™ê¸°í™”í–ˆê¸°ì—, ë™ì‹œì— ë™ì¼í•œ ê°’ë§Œ ê°€ì§‘ë‹ˆë‹¤.

<br>

- ë” ì˜ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„  ë‹¤ë¥¸ ì˜ˆì‹œê°€ í•„ìš”í•©ë‹ˆë‹¤.
- `Form` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚´í´ë´…ì‹œë‹¤.

```js
import { useState } from 'react';

export default function Form() {
  const [firstName, setFirstName] = useState('Mary');
  const [lastName, setLastName] = useState('Poppins');

  function handleFirstNameChange(e) {
    setFirstName(e.target.value);
  }

  function handleLastNameChange(e) {
    setLastName(e.target.value);
  }

  return (
    <>
      <label>
        First name:
        <input value={firstName} onChange={handleFirstNameChange} />
      </label>
      <label>
        Last name:
        <input value={lastName} onChange={handleLastNameChange} />
      </label>
      <p>
        <b>
          Good morning, {firstName} {lastName}.
        </b>
      </p>
    </>
  );
}
```

<br>

- ê° ì…ë ¥ í•„ë“œì—ëŠ” ì¤‘ë³µëœ ë¡œì§ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

1. ìƒíƒœ (`firstName`, `lastName`)
2. ë³€ê²½ í•¸ë“¤ëŸ¬ (`handleFirstNameChange`, `handleLastNameChange`)
3. `JSX`ì—ëŠ” í•´ë‹¹ ì…ë ¥ì— ëŒ€í•œ `value`, `onChange` ì–´íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ë¶€ë¶„ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

<br>

- ì•„ë˜ `useFormInput` ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•˜ì—¬ ì¤‘ë³µ ë¡œì§ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// App.js
import { useFormInput } from './useFormInput.js';

export default function Form() {
  const firstNameProps = useFormInput('Mary');
  const lastNameProps = useFormInput('Poppins');

  return (
    <>
      <label>
        First name:
        <input {...firstNameProps} />
      </label>
      <label>
        Last name:
        <input {...lastNameProps} />
      </label>
      <p>
        <b>
          Good morning, {firstNameProps.value} {lastNameProps.value}.
        </b>
      </p>
    </>
  );
}
```

```js
// useFormInput.js
import { useState } from 'react';

export function useFormInput(initialValue) {
  const [value, setValue] = useState(initialValue);

  function handleChange(e) {
    setValue(e.target.value);
  }

  const inputProps = {
    value: value,
    onChange: handleChange,
  };

  return inputProps;
}
```

<br>

- `value`ë¡œ ë¶ˆë¦¬ëŠ” **1ê°œ** ìƒíƒœ ë³€ìˆ˜ë§Œ ì„ ì–¸í•˜ëŠ” ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.

<br>

- í•˜ì§€ë§Œ `Form` ì»´í¬ë„ŒíŠ¸ëŠ” `useFormInput`ì„ 2ë²ˆ í˜¸ì¶œí•©ë‹ˆë‹¤.

```js
function Form() {
  const firstNameProps = useFormInput('Mary');
  const lastNameProps = useFormInput('Poppins');
  // ...
}
```

<br>

- 2ê°œì˜ ë¶„ë¦¬ëœ ìƒíƒœ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤.

<br>

- **ì»¤ìŠ¤í…€ í›…ì€ ìƒíƒœ ì €ì¥ ë¡œì§ì„ ê³µìœ í•˜ëŠ” ê²ƒì´ì§€, ìƒíƒœ ìì²´ë¥¼ ê³µìœ í•˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.**
- **`Hook`ì— ëŒ€í•œ ëª¨ë“  í˜¸ì¶œì€ ë™ì¼í•œ `Hook`ì— ëŒ€í•œ ë‹¤ë¥¸ í˜¸ì¶œê³¼ ì™„ì „íˆ ë…ë¦½ì ì…ë‹ˆë‹¤.**
- ìœ„ 2ê°œì˜ ì½”ë“œ ìƒŒë“œë°•ìŠ¤ê°€ ì™„ì „íˆ ë™ì¼í•œ ì´ìœ ì…ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook`ì„ ì¶”ì¶œí•˜ê¸° ì „ê³¼ í›„ì˜ ë™ì‘ì€ ì™„ì „íˆ ì¼ì¹˜í•©ë‹ˆë‹¤.

<br>

- ì»´í¬ë„ŒíŠ¸ ê°„ì— ìƒíƒœ ìì²´ë¥¼ ê³µìœ í•´ì•¼ í•˜ëŠ” ê²½ìš° **ìƒíƒœ ëŒì–´ì˜¬ë¦¬ê¸°**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

<br>

## Hook ì‚¬ì´ì— ë°˜ì‘í˜• ê°’ ì „ë‹¬í•˜ê¸°

- ì»¤ìŠ¤í…€ `Hook` ë‚´ë¶€ì˜ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë  ë•Œë§ˆë‹¤ ë¦¬ë Œë”ë§ë©ë‹ˆë‹¤.
- ì»´í¬ë„ŒíŠ¸ì™€ ë¹„ìŠ·í•˜ê²Œ ì»¤ìŠ¤í…€ `Hook`ì´ **ìˆœìˆ˜í•´ì•¼ í•˜ëŠ”** ì´ìœ ì…ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook` ì½”ë“œë¥¼ ì»´í¬ë„ŒíŠ¸ ì¼ë¶€ë¼ê³  ìƒê°í•˜ì„¸ìš”!

<br>

- ì»¤ìŠ¤í…€ `Hook`ì€ ì»´í¬ë„ŒíŠ¸ì™€ í•¨ê»˜ ë¦¬ë Œë”ë§ë˜ê¸° ë•Œë¬¸ì— í•­ìƒ ìµœì‹  `props`ì™€ ìƒíƒœë¥¼ ì „ë‹¬ë°›ìŠµë‹ˆë‹¤.
- `ChatRoom` ì˜ˆì œë¥¼ ì‚´í´ë´…ì‹œë‹¤.

```js
// App.js
import { useState } from 'react';
import ChatRoom from './ChatRoom.js';

export default function App() {
  const [roomId, setRoomId] = useState('general');
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select value={roomId} onChange={(e) => setRoomId(e.target.value)}>
          <option value='general'>general</option>
          <option value='travel'>travel</option>
          <option value='music'>music</option>
        </select>
      </label>
      <hr />
      <ChatRoom roomId={roomId} />
    </>
  );
}
```

```js
// ChatRoom.js
import { useState, useEffect } from 'react';
import { createConnection } from './chat.js';
import { showNotification } from './notifications.js';

export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.on('message', (msg) => {
      showNotification('New message: ' + msg);
    });
    connection.connect();
    return () => connection.disconnect();
  }, [roomId, serverUrl]);

  return (
    <>
      <label>
        Server URL:
        <input
          value={serverUrl}
          onChange={(e) => setServerUrl(e.target.value)}
        />
      </label>
      <h1>Welcome to the {roomId} room!</h1>
    </>
  );
}
```

```js
// chat.js
export function createConnection({ serverUrl, roomId }) {
  // ì„œë²„ì— ì‹¤ì œë¡œ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ì½”ë“œ
  if (typeof serverUrl !== 'string') {
    throw Error('Expected serverUrl to be a string. Received: ' + serverUrl);
  }
  if (typeof roomId !== 'string') {
    throw Error('Expected roomId to be a string. Received: ' + roomId);
  }
  let intervalId;
  let messageCallback;
  return {
    connect() {
      console.log(
        'âœ… Connecting to "' + roomId + '" room at ' + serverUrl + '...'
      );
      clearInterval(intervalId);
      intervalId = setInterval(() => {
        if (messageCallback) {
          if (Math.random() > 0.5) {
            messageCallback('hey');
          } else {
            messageCallback('lol');
          }
        }
      }, 3000);
    },
    disconnect() {
      clearInterval(intervalId);
      messageCallback = null;
      console.log(
        'âŒ Disconnected from "' + roomId + '" room at ' + serverUrl + ''
      );
    },
    on(event, callback) {
      if (messageCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'message') {
        throw Error('Only "message" event is supported.');
      }
      messageCallback = callback;
    },
  };
}
```

```js
// notification.js
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme = 'dark') {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

<br>

- `serverUrl`ì´ë‚˜ `roomId`ë¥¼ ë³€ê²½í•  ë•Œ `Effect`ëŠ” ë³€ê²½ì— **ë°˜ì‘**í•˜ê³  ì¬ë™ê¸°í™”í•©ë‹ˆë‹¤.
- `Effect`ì˜ ì¢…ì†ì„±ì„ ë³€ê²½í•  ë•Œë§ˆë‹¤ ì±„íŒ…ë°©ì´ ë‹¤ì‹œ ì—°ê²°ëœë‹¤ëŠ” ê²ƒì„ ì½˜ì†” ë©”ì‹œì§€ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- `Effect` ì½”ë“œë¥¼ ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ ì´ë™í•´ë³´ê² ìŠµë‹ˆë‹¤.

```js
export function useChatRoom({ serverUrl, roomId }) {
  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.connect();
    connection.on('message', (msg) => {
      showNotification('New message: ' + msg);
    });
    return () => connection.disconnect();
  }, [roomId, serverUrl]);
}
```

<br>

- ì´ë ‡ê²Œ í•˜ë©´ `ChatRoom` ì»´í¬ë„ŒíŠ¸ê°€ ë‚´ë¶€ì—ì„œ ì‘ë™í•˜ëŠ” ë°©ì‹ì— ëŒ€í•´ ê±±ì •í•˜ì§€ ì•Šê³  ì»¤ìŠ¤í…€ `Hook`ì„ í˜¸ì¶œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
  });

  return (
    <>
      <label>
        Server URL:
        <input
          value={serverUrl}
          onChange={(e) => setServerUrl(e.target.value)}
        />
      </label>
      <h1>Welcome to the {roomId} room!</h1>
    </>
  );
}
```

<br>

- í›¨ì‹  ê¹”ë”í•´ ë³´ì´ì£ ?

<br>

- ë¡œì§ì€ ì—¬ì „íˆ `prop`ê³¼ ìƒíƒœì— ë°˜ì‘í•˜ê³  ìˆìŠµë‹ˆë‹¤.

```js
// ChatRoom.js
import { useState } from 'react';
import { useChatRoom } from './useChatRoom.js';

export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
  });

  return (
    <>
      <label>
        Server URL:
        <input
          value={serverUrl}
          onChange={(e) => setServerUrl(e.target.value)}
        />
      </label>
      <h1>Welcome to the {roomId} room!</h1>
    </>
  );
}
```

<br>

- `Hook` 1ê°œì˜ ë°˜í™˜ ê°’ì„ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

```js
export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
  });
  // ...
}
```

<br>

- ê·¸ë¦¬ê³  ë‹¤ë¥¸ `Hook`ì— ì…ë ¥ìœ¼ë¡œ ì „ë‹¬í•˜ì„¸ìš”.

```js
export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
  });
  // ...
}
```

<br>

- `ChatRoom` ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œë§ˆë‹¤ ìµœì‹ ì˜ `roomId`, `serverUrl`ì„ `Hook`ì— ì „ë‹¬í•©ë‹ˆë‹¤.
- ì´ê²ƒì´ ë¦¬ë Œë”ë§ í›„ ê°’ì´ ë‹¤ë¥¼ ë•Œë§ˆë‹¤ `Effect`ê°€ ì±„íŒ…ë°©ì— ë‹¤ì‹œ ì—°ê²°ë˜ëŠ” ì´ìœ ì…ë‹ˆë‹¤.

<br>

## ì»¤ìŠ¤í…€ Hookì— ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì „ë‹¬í•˜ê¸°

- ì´ ì„¹ì…˜ì€ ì•„ì§ `React`ì— ì¶”ê°€ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì•„ì§ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ì‹¤í—˜ì  APIì…ë‹ˆë‹¤.

<br>

- ì»´í¬ë„ŒíŠ¸ì—ì„œ `useChatRoom`ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ê°€ í•´ë‹¹ ë™ì‘ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ë©”ì‹œì§€ê°€ ë„ì°©í•  ë•Œ ìˆ˜í–‰í•  ì‘ì—…ì— ëŒ€í•œ ë¡œì§ì€ `Hook` ë‚´ë¶€ì— í•˜ë“œ ì½”ë”©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```js
export function useChatRoom({ serverUrl, roomId }) {
  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.connect();
    connection.on('message', (msg) => {
      showNotification('New message: ' + msg);
    });
    return () => connection.disconnect();
  }, [roomId, serverUrl]);
}
```

<br>

- ì´ ë¡œì§ì„ ì»´í¬ë„ŒíŠ¸ë¡œ ë‹¤ì‹œ ì´ë™í•œë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.

```js
export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
    onReceiveMessage(msg) {
      showNotification('New message: ' + msg);
    },
  });
  // ...
}
```

<br>

- ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ ì»¤ìŠ¤í…€ `Hook`ì„ ë³€ê²½í•˜ì—¬ ì¢…ì†ì„± ì¤‘ í•˜ë‚˜ë¡œ `onReceiveMessage`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```js
export function useChatRoom({ serverUrl, roomId, onReceiveMessage }) {
  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.connect();
    connection.on('message', (msg) => {
      onReceiveMessage(msg);
    });
    return () => connection.disconnect();
  }, [roomId, serverUrl, onReceiveMessage]); // âœ… ëª¨ë“  ì¢…ì†ì„±ì´ ì§€ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
}
```

<br>

- ì´ ë°©ë²•ì€ ë™ì‘í•˜ì§€ë§Œ ì»¤ìŠ¤í…€ `Hook`ì´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ í—ˆìš©í•  ë•Œ 1ê°œ ë” ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- `onRecieveMessage`ì„ ì¢…ì†ì„±ì— ì¶”ê°€í•˜ëŠ” ê²ƒì€ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œë§ˆë‹¤ ì±„íŒ…ë°©ì— ë‹¤ì‹œ ì—°ê²°ë˜ë„ë¡ í•˜ë¯€ë¡œ ì´ìƒì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ `Effect` ì´ë²¤íŠ¸ë¡œ ë˜í•‘í•˜ì—¬ ì¢…ì†ì„±ì—ì„œ ì œê±°í•©ë‹ˆë‹¤.

```js
import { useEffect, useEffectEvent } from 'react';
// ...

export function useChatRoom({ serverUrl, roomId, onReceiveMessage }) {
  const onMessage = useEffectEvent(onReceiveMessage);

  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.connect();
    connection.on('message', (msg) => {
      onMessage(msg);
    });
    return () => connection.disconnect();
  }, [roomId, serverUrl]); // âœ… ëª¨ë“  ì¢…ì†ì„±ì´ ì§€ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
}
```

<br>

- ì´ì œ `ChatRoom` ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë  ë•Œë§ˆë‹¤ ì±„íŒ…ë°©ì— ë‹¤ì‹œ ì—°ê²°ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ë‹¤ìŒì€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì»¤ìŠ¤í…€ `Hook`ì— ì „ë‹¬í•˜ì—¬ ìœ ì €ê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ëª¨ ë²„ì „ì…ë‹ˆë‹¤.

```js
// App.js
import { useState } from 'react';
import ChatRoom from './ChatRoom.js';

export default function App() {
  const [roomId, setRoomId] = useState('general');
  return (
    <>
      <label>
        Choose the chat room:{' '}
        <select value={roomId} onChange={(e) => setRoomId(e.target.value)}>
          <option value='general'>general</option>
          <option value='travel'>travel</option>
          <option value='music'>music</option>
        </select>
      </label>
      <hr />
      <ChatRoom roomId={roomId} />
    </>
  );
}
```

```js
// ChatRoom.js
import { useState } from 'react';
import { useChatRoom } from './useChatRoom.js';
import { showNotification } from './notifications.js';

export default function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  useChatRoom({
    roomId: roomId,
    serverUrl: serverUrl,
    onReceiveMessage(msg) {
      showNotification('New message: ' + msg);
    },
  });

  return (
    <>
      <label>
        Server URL:
        <input
          value={serverUrl}
          onChange={(e) => setServerUrl(e.target.value)}
        />
      </label>
      <h1>Welcome to the {roomId} room!</h1>
    </>
  );
}
```

```js
// useChatRoom.js
import { useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';
import { createConnection } from './chat.js';

export function useChatRoom({ serverUrl, roomId, onReceiveMessage }) {
  const onMessage = useEffectEvent(onReceiveMessage);

  useEffect(() => {
    const options = {
      serverUrl: serverUrl,
      roomId: roomId,
    };
    const connection = createConnection(options);
    connection.connect();
    connection.on('message', (msg) => {
      onMessage(msg);
    });
    return () => connection.disconnect();
  }, [roomId, serverUrl]);
}
```

```js
// chat.js
export function createConnection({ serverUrl, roomId }) {
  // ì„œë²„ì— ì‹¤ì œë¡œ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ì½”ë“œ
  if (typeof serverUrl !== 'string') {
    throw Error('Expected serverUrl to be a string. Received: ' + serverUrl);
  }
  if (typeof roomId !== 'string') {
    throw Error('Expected roomId to be a string. Received: ' + roomId);
  }
  let intervalId;
  let messageCallback;
  return {
    connect() {
      console.log(
        'âœ… Connecting to "' + roomId + '" room at ' + serverUrl + '...'
      );
      clearInterval(intervalId);
      intervalId = setInterval(() => {
        if (messageCallback) {
          if (Math.random() > 0.5) {
            messageCallback('hey');
          } else {
            messageCallback('lol');
          }
        }
      }, 3000);
    },
    disconnect() {
      clearInterval(intervalId);
      messageCallback = null;
      console.log(
        'âŒ Disconnected from "' + roomId + '" room at ' + serverUrl + ''
      );
    },
    on(event, callback) {
      if (messageCallback) {
        throw Error('Cannot add the handler twice.');
      }
      if (event !== 'message') {
        throw Error('Only "message" event is supported.');
      }
      messageCallback = callback;
    },
  };
}
```

```js
// notification.js
import Toastify from 'toastify-js';
import 'toastify-js/src/toastify.css';

export function showNotification(message, theme = 'dark') {
  Toastify({
    text: message,
    duration: 2000,
    gravity: 'top',
    position: 'right',
    style: {
      background: theme === 'dark' ? 'black' : 'white',
      color: theme === 'dark' ? 'white' : 'black',
    },
  }).showToast();
}
```

- `ChatRoom`ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ë™ì‘ ì›ë¦¬ë¥¼ ì•Œ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
- ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì— ì¶”ê°€í•˜ê³  ë‹¤ë¥¸ ì˜µì…˜ì„ ì „ë‹¬í•  ìˆ˜ ìˆìœ¼ë©° ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.
- ì´ê²ƒì´ ì»¤ìŠ¤í…€ `Hook`ì˜ í˜ì…ë‹ˆë‹¤.

<br>

## ì»¤ìŠ¤í…€ Hookì„ ì‚¬ìš©í•  ë•Œ

- ì¤‘ë³µëœ ëª¨ë“  ì½”ë“œë¥¼ ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ ì¶”ì¶œí•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.
- ì¼ë¶€ ì¤‘ë³µì€ ê´œì°®ìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ë‹¨ì¼ `useState`ë¥¼ ë˜í•‘í•˜ê¸° ìœ„í•´ `useFormInput` `Hook`ì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì€ ë¶ˆí•„ìš”í•©ë‹ˆë‹¤.

<br>

- ê·¸ëŸ¬ë‚˜ `Effect`ë¥¼ ì‘ì„±í•  ë•Œë§ˆë‹¤ ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ í¬ì¥í•˜ëŠ” ê²ƒì´ ë” ëª…í™•í•œì§€ ê³ ë¯¼í•´ì•¼ í•©ë‹ˆë‹¤.
- **`Effect`ë¥¼ ìì£¼ ì‚¬ìš©í•˜ë©´ ì•ˆ ë©ë‹ˆë‹¤.**
- `Effect`ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•˜ê±°ë‚˜ `React`ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” API ê°™ì€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ **`React` ë°–ìœ¼ë¡œ ì´ë™í•˜ëŠ”** ì‘ì—…ì˜ ì¡´ì¬ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ `Effect`ë¥¼ ë˜í•‘í•˜ë©´ ì˜ë„ì™€ ë°ì´í„° íë¦„ì„ ì •í™•í•˜ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- ì˜ˆë¥¼ ë“¤ì–´ 2ê°œì˜ ë“œë¡­ë‹¤ìš´ì„ í‘œì‹œí•˜ëŠ” `ShippingForm` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚´í´ë´…ì‹œë‹¤.
- í•˜ë‚˜ëŠ” ë„ì‹œ ëª©ë¡ì„ í‘œì‹œí•˜ê³  ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ë„ì‹œì˜ ì§€ì—­ ëª©ë¡ì„ í‘œì‹œí•©ë‹ˆë‹¤.

```js
function ShippingForm({ country }) {
  const [cities, setCities] = useState(null);
  // EffectëŠ” ë‚˜ë¼ì˜ ë„ì‹œë¥¼ í˜ì¹˜í•©ë‹ˆë‹¤.
  useEffect(() => {
    let ignore = false;
    fetch(`/api/cities?country=${country}`)
      .then((response) => response.json())
      .then((json) => {
        if (!ignore) {
          setCities(json);
        }
      });
    return () => {
      ignore = true;
    };
  }, [country]);

  const [city, setCity] = useState(null);
  const [areas, setAreas] = useState(null);
  // EffectëŠ” ì„ íƒëœ ë„ì‹œì˜ ì§€ì—­ì„ í˜ì¹˜í•©ë‹ˆë‹¤.
  useEffect(() => {
    if (city) {
      let ignore = false;
      fetch(`/api/areas?city=${city}`)
        .then((response) => response.json())
        .then((json) => {
          if (!ignore) {
            setAreas(json);
          }
        });
      return () => {
        ignore = true;
      };
    }
  }, [city]);

  // ...
}
```

<br>

- ìœ„ ì½”ë“œëŠ” ê½¤ ì¤‘ë³µë˜ì–´ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì„œë¡œ ë¶„ë¦¬í•˜ì—¬ ìœ ì§€í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
- ê·¸ë“¤ì€ ì„œë¡œ ë‹¤ë¥¸ 2ê°€ì§€ë¥¼ ë™ê¸°í™”í•˜ê¸° ë•Œë¬¸ì— 1ê°œì˜ `Effect`ë¡œ í•©ì³ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.
- ëŒ€ì‹  ìœ„ì˜ `ShippingForm` ì»´í¬ë„ŒíŠ¸ë¥¼ ìœ ì € ë°ì´í„° `Hook`ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ë‹¨ìˆœí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function useData(url) {
  const [data, setData] = useState(null);
  useEffect(() => {
    if (url) {
      let ignore = false;
      fetch(url)
        .then((response) => response.json())
        .then((json) => {
          if (!ignore) {
            setData(json);
          }
        });
      return () => {
        ignore = true;
      };
    }
  }, [url]);
  return data;
}
```

<br>

- ì´ì œ `ShippingForm` ì»´í¬ë„ŒíŠ¸ì˜ 2ê°œ `Effect`ë¥¼ `useData` í˜¸ì¶œë¡œ êµì²´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function ShippingForm({ country }) {
  const cities = useData(`/api/cities?country=${country}`);
  const [city, setCity] = useState(null);
  const areas = useData(city ? `/api/areas?city=${city}` : null);
  // ...
}
```

<br>

- ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ ì¶”ì¶œí•˜ë©´ ë°ì´í„° íë¦„ì´ ëª…í™•í•´ì§‘ë‹ˆë‹¤.
- `url`ì„ ì…ë ¥í•˜ê³  `data`ë¥¼ ë°–ìœ¼ë¡œ êº¼ëƒ…ë‹ˆë‹¤.
- `useData` ë‚´ë¶€ì—ì„œ `Effect`ë¥¼ **ìˆ¨ê¸°ë©´** `ShippingForm` ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‘ì—…í•˜ëŠ” ì‚¬ëŒì´ ë¶ˆí•„ìš”í•œ ì¢…ì†ì„±ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ìƒì ìœ¼ë¡œ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ `Effect`ì˜ ëŒ€ë¶€ë¶„ì€ ì»¤ìŠ¤í…€ `Hook`ì— ì¡´ì¬í•©ë‹ˆë‹¤.

<br>

## Deep Dive - êµ¬ì²´ì ì¸ ê³ ê¸‰ ì‚¬ìš© ì‚¬ë¡€ì— ì´ˆì ì„ ë§ì¶˜ ì»¤ìŠ¤í…€ Hookì„ ìœ ì§€í•˜ì„¸ìš”.

- ë¨¼ì € ì»¤ìŠ¤í…€ `Hook`ì˜ ì´ë¦„ì„ ì„ íƒí•©ë‹ˆë‹¤.
- ëª…í™•í•œ ì´ë¦„ ì„ íƒì— ì–´ë ¤ì›€ì´ ì¡´ì¬í•œë‹¤ë©´ `Effect`ê°€ ì»´í¬ë„ŒíŠ¸ì˜ ë‚˜ë¨¸ì§€ ë¡œì§ê³¼ ê²°í•©ë˜ì–´ ì•„ì§ ì¶”ì¶œë  ì¤€ë¹„ê°€ ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

<br>

- ì½”ë“œë¥¼ ìì£¼ ì‘ì„±í•˜ì§€ ì•ŠëŠ” ì‚¬ëŒë„ ì»¤ìŠ¤í…€ `Hook`ì´ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…, ë°˜í™˜í•˜ëŠ” ì‘ì—…ì— ëŒ€í•´ ì¶©ë¶„íˆ ì¶”ì¸¡í•  ìˆ˜ ìˆì„ ì •ë„ë¡œ ì»¤ìŠ¤í…€ `Hook`ì˜ ì´ë¦„ì´ ëª…í™•í•´ì•¼ í•©ë‹ˆë‹¤.

<br>

- âœ… `useData(url)`
- âœ… `useImpressionLog(eventName, extraData)`
- âœ… `useChatRoom(options)`

<br>

- ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•  ë•Œ ì»¤ìŠ¤í…€ `Hook` ì´ë¦„ì´ ë” ê¸°ìˆ ì ì´ê³  í•´ë‹¹ ì‹œìŠ¤í…œê³¼ ê´€ë ¨ëœ ì „ë¬¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ ì‹œìŠ¤í…œì— ìµìˆ™í•œ ì‚¬ëŒì´ ì´í•´í•  ìˆ˜ ìˆëŠ” ì´ë¦„ì´ ì¢‹ìŠµë‹ˆë‹¤.

<br>

- âœ… `useMediaQuery(query)`
- âœ… `useSocket(url)`
- âœ… `useIntersectionObserver(ref, options)`

<br>

- **êµ¬ì²´ì ì¸ ê³ ê¸‰ ì‚¬ìš© ì‚¬ë¡€ì— ì´ˆì ì„ ë§ì¶˜ ì»¤ìŠ¤í…€ Hookì„ ìœ ì§€í•˜ì„¸ìš”.**
- `Effect` API ìì²´ì— ëŒ€í•œ ëŒ€ì•ˆê³¼ í¸ì˜ ë˜í¼ ì—­í• ì„ í•˜ëŠ” ì»¤ìŠ¤í…€ **ìƒëª… ì£¼ê¸°** `Hook`ì„ ìƒì„±í•˜ê³  ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.

<br>

- ğŸ”´ `useMount(fn)`
- ğŸ”´ `useEffectOnce(fn)`
- ğŸ”´ `useUpdateEffect(fn)`

<br>

- ì˜ˆë¥¼ ë“¤ì–´ `useMount` `Hook`ì€ ì¼ë¶€ ì½”ë“œê°€ **ë§ˆìš´íŠ¸ë  ë•Œë§Œ** ì‹¤í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤.

```js
function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  // ğŸ”´ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: ì»¤ìŠ¤í…€ Hook "lifecycle"ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒ
  useMount(() => {
    const connection = createConnection({ roomId, serverUrl });
    connection.connect();

    post('/analytics/event', { eventName: 'visit_chat' });
  });
  // ...
}

// ğŸ”´ ê¶Œì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: ì»¤ìŠ¤í…€ Hook "lifecycle"ì„ ìƒì„±í•˜ëŠ” ê²ƒ
function useMount(fn) {
  useEffect(() => {
    fn();
  }, []); // ğŸ”´ useEffectì— ëˆ„ë½ëœ ì¢…ì†ì„±ì´ ìˆìŠµë‹ˆë‹¤. (fn)
}
```

<br>

- `useMount`ì™€ ê°™ì€ ì»¤ìŠ¤í…€ **ìƒëª… ì£¼ê¸°** `Hook`ì€ `React` íŒ¨ëŸ¬ë‹¤ì„ì— ì˜ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ì´ ì½”ë“œ ì˜ˆì œëŠ” ì‹¤ìˆ˜ê°€ ì¡´ì¬í•©ë‹ˆë‹¤.
- (`roomId` í˜¹ì€ `serverUrl` ë³€ê²½ì— **ë°˜ì‘**í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.)
- í•˜ì§€ë§Œ ë¦°í„°ëŠ” ì§ì ‘ì ìœ¼ë¡œ `useEffect` í˜¸ì¶œë§Œ í™•ì¸í•˜ë¯€ë¡œ ê²½ê³ ë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

<br>

- `Effect`ë¥¼ ì‘ì„±í•˜ëŠ” ê²½ìš° `React` APIë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì—¬ ì‹œì‘í•©ë‹ˆë‹¤.

```js
function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  // âœ… êµ¿: 2ê°œì˜ EffectëŠ” ëª©ì ì— ë”°ë¼ ë¶„ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.

  useEffect(() => {
    const connection = createConnection({ serverUrl, roomId });
    connection.connect();
    return () => connection.disconnect();
  }, [serverUrl, roomId]);

  useEffect(() => {
    post('/analytics/event', { eventName: 'visit_chat', roomId });
  }, [roomId]);
  // ...
}
```

<br>

- ê·¸ëŸ° ë‹¤ìŒ ë‹¤ì–‘í•œ ê³ ê¸‰ ì‚¬ë¡€ì— ëŒ€í•´ ì»¤ìŠ¤í…€ `Hook`ì„ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
function ChatRoom({ roomId }) {
  const [serverUrl, setServerUrl] = useState('https://localhost:1234');

  // âœ… í›Œë¥­í•´ìš”: ìš©ë„ì— ë”°ë¼ ì´ë¦„ì´ ë¶™ì—¬ì§„ ì»¤ìŠ¤í…€ Hook
  useChatRoom({ serverUrl, roomId });
  useImpressionLog('visit_chat', { roomId });
  // ...
}
```

<br>

- **ì¢‹ì€ ì»¤ìŠ¤í…€ `Hook`ì€ í˜¸ì¶œ ì½”ë“œê°€ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…ì„ ì œí•œí•˜ì—¬ í˜¸ì¶œ ì½”ë“œë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ë§Œë“­ë‹ˆë‹¤.**
- ì˜ˆë¥¼ ë“¤ì–´ `useChatRoom(options)`ì€ ì±„íŒ…ë°©ì—ë§Œ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ë°˜ë©´, `useImpressionLog(eventName, extraData)`ëŠ” ë¶„ì„ì— ë…¸ì¶œ ë¡œê·¸ë§Œ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook` APIê°€ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ì œí•œí•˜ì§€ ì•Šê³  ë§¤ìš° ì¶”ìƒì ì´ë¼ë©´, ì¥ê¸°ì ìœ¼ë¡œ ë” ë§ì€ ë¬¸ì œë¥¼ ì•¼ê¸°í•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

<br>

## ì»¤ìŠ¤í…€ Hookì€ ë” ë‚˜ì€ íŒ¨í„´ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

- `Effect`ëŠ” **escape hatch**ì…ë‹ˆë‹¤.
- `React` ì™¸ë¶€ë¡œ ë‚˜ê°€ì•¼í•  ë•Œë‚˜ ë” ë‚˜ì€ ë‚´ì¥ ì†”ë£¨ì…˜ì´ ì—†ì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ `React`ì˜ ëª©í‘œëŠ” ë³´ë‹¤ êµ¬ì²´ì ì¸ ë¬¸ì œì— êµ¬ì²´ì ì¸ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ì—¬ `Effect` ê°œìˆ˜ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook`ì˜ ë˜í•‘ `Effect`ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ëŸ¬í•œ ì†”ë£¨ì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œ ë” ì‰½ê²Œ ì—…ê·¸ë ˆì´ë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// App.js
import { useOnlineStatus } from './useOnlineStatus.js';

function StatusBar() {
  const isOnline = useOnlineStatus();
  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}

function SaveButton() {
  const isOnline = useOnlineStatus();

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}

export default function App() {
  return (
    <>
      <SaveButton />
      <StatusBar />
    </>
  );
}
```

```js
// useOnlineStatus.js
import { useState, useEffect } from 'react';

export function useOnlineStatus() {
  const [isOnline, setIsOnline] = useState(true);
  useEffect(() => {
    function handleOnline() {
      setIsOnline(true);
    }
    function handleOffline() {
      setIsOnline(false);
    }
    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);
    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);
  return isOnline;
}
```

<br>

- ìœ„ ì˜ˆì œì—ì„œ `useOnlineStatus`ëŠ” `useState`ì™€ `useEffect`ì˜ ìŒìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ ì´ëŠ” ìµœì ì˜ ë°©ë²•ì´ ì•„ë‹™ë‹ˆë‹¤.
- ê³ ë ¤ë˜ì§€ ì•Šì€ ì—£ì§€ ì¼€ì´ìŠ¤ê°€ ë§ìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ë  ë•Œ `isOnline`ì€ ì´ë¯¸ `true`ì§€ë§Œ, ì´ë¯¸ ì˜¤í”„ë¼ì¸ ìƒíƒœê°€ ëœ ê²½ìš°ì—ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
- ë¸Œë¼ìš°ì €ì—ì„œ `navigator.onLine` APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì§€ë§Œ ì„œë²„ì—ì„œ `React` ì•±ì„ ì‹¤í–‰í•˜ì—¬ ì²« `HTML`ì„ ìƒì„±í•˜ë©´ ì ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- ê°„ë‹¨íˆ ë§í•´ì„œ ì½”ë“œëŠ” ë¦¬íŒ©í† ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- ë‹¤í–‰íˆ `React 18`ì—ëŠ” `useSyncExternalStore`ë¼ëŠ” ì „ìš© APIê°€ í¬í•¨ë˜ì–´ ìˆì–´ ì´ëŸ¬í•œ ëª¨ë“  ë¬¸ì œë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- ì•„ë˜ëŠ” ì´ ìƒˆë¡œìš´ APIë¥¼ í™œìš©í•˜ê¸° ìœ„í•´ ë‹¤ì‹œ ì‘ì„±ëœ `useOnlineStatus` `Hook`ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

```js
// App.js
import { useOnlineStatus } from './useOnlineStatus.js';

function StatusBar() {
  const isOnline = useOnlineStatus();
  return <h1>{isOnline ? 'âœ… Online' : 'âŒ Disconnected'}</h1>;
}

function SaveButton() {
  const isOnline = useOnlineStatus();

  function handleSaveClick() {
    console.log('âœ… Progress saved');
  }

  return (
    <button disabled={!isOnline} onClick={handleSaveClick}>
      {isOnline ? 'Save progress' : 'Reconnecting...'}
    </button>
  );
}

export default function App() {
  return (
    <>
      <SaveButton />
      <StatusBar />
    </>
  );
}
```

```js
// useOnlineStatus.js
import { useSyncExternalStore } from 'react';

function subscribe(callback) {
  window.addEventListener('online', callback);
  window.addEventListener('offline', callback);
  return () => {
    window.removeEventListener('online', callback);
    window.removeEventListener('offline', callback);
  };
}

export function useOnlineStatus() {
  return useSyncExternalStore(
    subscribe,
    () => navigator.onLine, // í´ë¼ì´ì–¸íŠ¸ ë‹¨ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
    () => true // ì„œë²„ ë‹¨ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
  );
}
```

<br>

- ì´ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ë‹¤ëŠ” ì ì„ í™•ì¸í•˜ì„¸ìš”.

```js
function StatusBar() {
  const isOnline = useOnlineStatus();
  // ...
}

function SaveButton() {
  const isOnline = useOnlineStatus();
  // ...
}
```

<br>

- ì•„ë˜ëŠ” ì»¤ìŠ¤í…€ `Hook`ì—ì„œ `Effect`ë¥¼ ë˜í•‘í•˜ëŠ” ê²ƒì´ ìœ ìš©í•œ ë˜ ë‹¤ë¥¸ ì´ìœ ì…ë‹ˆë‹¤.

<br>

1. `Effect`ì˜ ë°ì´í„° íë¦„ì´ êµ‰ì¥íˆ ëª…í™•í•´ì§‘ë‹ˆë‹¤.
2. ì»´í¬ë„ŒíŠ¸ê°€ `Effect`ì˜ ì •í™•í•œ êµ¬í˜„ë³´ë‹¤ ì˜ë„ì— ì´ˆì ì„ ë§ì¶”ë„ë¡ í•©ë‹ˆë‹¤.
3. `React`ê°€ ìƒˆ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ì´ëŸ¬í•œ `Effect`ë¥¼ ì œê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

- **ë””ìì¸ ì‹œìŠ¤í…œ**ê³¼ ìœ ì‚¬í•˜ê²Œ ì•±ì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¼ë°˜ì ì¸ ê´€ìš©êµ¬ë¥¼ ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ ì¶”ì¶œí•˜ëŠ” ê²ƒì´ ìœ ìš©í•  ê²ë‹ˆë‹¤.
- ì´ë ‡ê²Œ í•˜ë©´ ì»´í¬ë„ŒíŠ¸ì˜ ì½”ë“œê°€ ì˜ë„ì— ì´ˆì ì„ ë§ì¶œ ìˆ˜ ìˆê³  `Effect`ë¥¼ ìì£¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

<br>

## Deep Dive - ReactëŠ” ë°ì´í„° í˜ì¹˜ì— ëŒ€í•œ ë¹ŒíŠ¸ì¸ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ë‚˜ìš”?

- ì„¸ë¶€ ì‚¬í•­ì„ ì•„ì§ ì—°êµ¬í•˜ê³  ìˆìœ¼ë©° ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ì„ ì‚¬ìš©í•  ê²ƒì…ë‹ˆë‹¤.

```js
import { use } from 'react'; // ì•„ì§ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤!

function ShippingForm({ country }) {
  const cities = use(fetch(`/api/cities?country=${country}`));
  const [city, setCity] = useState(null);
  const areas = city ? use(fetch(`/api/areas?city=${city}`)) : null;
  // ...
}
```

<br>

## ë˜ ë‹¤ë¥¸ ë°©ë²•ë„ ì¡´ì¬í•©ë‹ˆë‹¤.

- ë¸Œë¼ìš°ì €ì˜ `requestAnimationFrame` APIë¥¼ **ì‚¬ìš©í•˜ì—¬** ì²˜ìŒë¶€í„° í˜ì´ë“œì¸ ì—ë‹ˆë©”ì´ì…˜ì„ êµ¬í˜„í•˜ê³  ì‹¶ë‹¤ê³  ê°€ì •í•´ë´…ì‹œë‹¤.
- ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„ë¥¼ ì„¤ì •í•˜ëŠ” `Effect`ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì• ë‹ˆë©”ì´ì…˜ì˜ ê° í”„ë ˆì„ ë™ì•ˆ, `1`ì— ë„ë‹¬í•  ë•Œê¹Œì§€ `ref`ì— ë³´ìœ í•˜ê³  ìˆëŠ” `DOM` ë…¸ë“œì˜ ë¶ˆíˆ¬ëª…ë„ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
import { useState, useEffect, useRef } from 'react';

function Welcome() {
  const ref = useRef(null);

  useEffect(() => {
    const duration = 1000;
    const node = ref.current;

    let startTime = performance.now();
    let frameId = null;

    function onFrame(now) {
      const timePassed = now - startTime;
      const progress = Math.min(timePassed / duration, 1);
      onProgress(progress);
      if (progress < 1) {
        // í™”ë©´ì— í‘œí˜„í•  í”„ë ˆì„ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.
        frameId = requestAnimationFrame(onFrame);
      }
    }

    function onProgress(progress) {
      node.style.opacity = progress;
    }

    function start() {
      onProgress(0);
      startTime = performance.now();
      frameId = requestAnimationFrame(onFrame);
    }

    function stop() {
      cancelAnimationFrame(frameId);
      startTime = null;
      frameId = null;
    }

    start();
    return () => stop();
  }, []);

  return (
    <h1 className='welcome' ref={ref}>
      Welcome
    </h1>
  );
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>{show ? 'Remove' : 'Show'}</button>
      <hr />
      {show && <Welcome />}
    </>
  );
}
```

<br>

- ê°€ë…ì„±ì´ ì¢‹ì€ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ê¸° ìœ„í•´ `useFadeIn` ì»¤ìŠ¤í…€ `Hook`ìœ¼ë¡œ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
import { useState, useEffect, useRef } from 'react';
import { useFadeIn } from './useFadeIn.js';

function Welcome() {
  const ref = useRef(null);

  useFadeIn(ref, 1000);

  return (
    <h1 className='welcome' ref={ref}>
      Welcome
    </h1>
  );
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>{show ? 'Remove' : 'Show'}</button>
      <hr />
      {show && <Welcome />}
    </>
  );
}
```

```js
import { useEffect } from 'react';

export function useFadeIn(ref, duration) {
  useEffect(() => {
    const node = ref.current;

    let startTime = performance.now();
    let frameId = null;

    function onFrame(now) {
      const timePassed = now - startTime;
      const progress = Math.min(timePassed / duration, 1);
      onProgress(progress);
      if (progress < 1) {
        // í™”ë©´ì— í‘œí˜„í•  í”„ë ˆì„ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.
        frameId = requestAnimationFrame(onFrame);
      }
    }

    function onProgress(progress) {
      node.style.opacity = progress;
    }

    function start() {
      onProgress(0);
      startTime = performance.now();
      frameId = requestAnimationFrame(onFrame);
    }

    function stop() {
      cancelAnimationFrame(frameId);
      startTime = null;
      frameId = null;
    }

    start();
    return () => stop();
  }, [ref, duration]);
}
```

<br>

- `useFadeIn` ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•  ìˆ˜ ìˆì§€ë§Œ, ë” ë¦¬íŒ©í† ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ `useFadeIn`ì—ì„œ ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•œ ë¡œì§ì„ `useAnimationLoop`ë¼ëŠ” ìƒˆë¡œìš´ ì»¤ìŠ¤í…€ `Hook`ë¡œ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// App.js
import { useState, useEffect, useRef } from 'react';
import { useFadeIn } from './useFadeIn.js';

function Welcome() {
  const ref = useRef(null);

  useFadeIn(ref, 1000);

  return (
    <h1 className='welcome' ref={ref}>
      Welcome
    </h1>
  );
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>{show ? 'Remove' : 'Show'}</button>
      <hr />
      {show && <Welcome />}
    </>
  );
}
```

```js
// useFadeIn.js
import { useState, useEffect } from 'react';
import { experimental_useEffectEvent as useEffectEvent } from 'react';

export function useFadeIn(ref, duration) {
  const [isRunning, setIsRunning] = useState(true);

  useAnimationLoop(isRunning, (timePassed) => {
    const progress = Math.min(timePassed / duration, 1);
    ref.current.style.opacity = progress;
    if (progress === 1) {
      setIsRunning(false);
    }
  });
}

function useAnimationLoop(isRunning, drawFrame) {
  const onFrame = useEffectEvent(drawFrame);

  useEffect(() => {
    if (!isRunning) {
      return;
    }

    const startTime = performance.now();
    let frameId = null;

    function tick(now) {
      const timePassed = now - startTime;
      onFrame(timePassed);
      frameId = requestAnimationFrame(tick);
    }

    tick();
    return () => cancelAnimationFrame(frameId);
  }, [isRunning]);
}
```

<br>

- í•˜ì§€ë§Œ ê¼­ ê·¸ë ‡ê²Œ í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.
- ì¼ë°˜ í•¨ìˆ˜ì™€ ë¹„ìŠ·í•˜ê²Œ, ê¶ê·¹ì ìœ¼ë¡œ ì½”ë“œì˜ ë‹¤ë¥¸ ë¶€ë¶„ì˜ ì‚¬ì´ì— ê²½ê³„ë¥¼ ê·¸ë¦´ ìœ„ì¹˜ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´ ë§¤ìš° ë‹¤ë¥¸ ì ‘ê·¼ ë°©ì‹ì„ ì·¨í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- ë¡œì§ì„ `Effect` ë‚´ë¶€ì—ì„œ ìœ ì§€í•˜ëŠ” ëŒ€ì‹ , ëŒ€ë¶€ë¶„ì˜ ëª…ë ¹ ë¡œì§ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ í´ë˜ìŠ¤ ë‚´ë¶€ë¡œ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```js
// App.js
import { useState, useEffect, useRef } from 'react';
import { useFadeIn } from './useFadeIn.js';

function Welcome() {
  const ref = useRef(null);

  useFadeIn(ref, 1000);

  return (
    <h1 className='welcome' ref={ref}>
      Welcome
    </h1>
  );
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>{show ? 'Remove' : 'Show'}</button>
      <hr />
      {show && <Welcome />}
    </>
  );
}
```

```js
// useFadeIn.js
import { useState, useEffect } from 'react';
import { FadeInAnimation } from './animation.js';

export function useFadeIn(ref, duration) {
  useEffect(() => {
    const animation = new FadeInAnimation(ref.current);
    animation.start(duration);
    return () => {
      animation.stop();
    };
  }, [ref, duration]);
}
```

```js
// animation.js
export class FadeInAnimation {
  constructor(node) {
    this.node = node;
  }
  start(duration) {
    this.duration = duration;
    this.onProgress(0);
    this.startTime = performance.now();
    this.frameId = requestAnimationFrame(() => this.onFrame());
  }
  onFrame() {
    const timePassed = performance.now() - this.startTime;
    const progress = Math.min(timePassed / this.duration, 1);
    this.onProgress(progress);
    if (progress === 1) {
      this.stop();
    } else {
      // í™”ë©´ì— í‘œí˜„í•  í”„ë ˆì„ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.
      this.frameId = requestAnimationFrame(() => this.onFrame());
    }
  }
  onProgress(progress) {
    this.node.style.opacity = progress;
  }
  stop() {
    cancelAnimationFrame(this.frameId);
    this.startTime = null;
    this.frameId = null;
    this.duration = 0;
  }
}
```

<br>

- `Effect`ë¥¼ ì‚¬ìš©í•˜ì—¬ `React`ë¥¼ ì™¸ë¶€ ì‹œìŠ¤í…œì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì—¬ëŸ¬ ì• ë‹ˆë©”ì´ì…˜ì„ ì—°ê²°í•˜ê¸° ìœ„í•´ `Effect` ê°„ì— ë” ë§ì€ ì¡°ì •ì´ í•„ìš”í• ìˆ˜ë¡, ìœ„ì˜ ì½”ë“œ ìƒŒë“œë°•ìŠ¤ì²˜ëŸ¼ `Effect`ì™€ `Hook`ì—ì„œ ë¡œì§ì„ ì™„ì „íˆ ì¶”ì¶œí•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì…ë‹ˆë‹¤.
- ê·¸ëŸ¬ë©´ ì¶”ì¶œí•œ ì½”ë“œê°€ **ì™¸ë¶€ ì‹œìŠ¤í…œ**ì´ ë©ë‹ˆë‹¤.
- ì´ë ‡ê²Œ í•˜ë©´ `React` ì™¸ë¶€ë¡œ ì´ë™í•œ ì‹œìŠ¤í…œì—ë§Œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´ ë˜ë¯€ë¡œ `Effect`ê°€ ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤.

<br>

- ìœ„ì˜ ì˜ˆëŠ” í˜ì´ë“œì¸ ë¡œì§ì´ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•œë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.
- í•˜ì§€ë§Œ íŠ¹ì • í˜ì´ë“œì¸ ì• ë‹ˆë©”ì´ì…˜ì€ `CSS`ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ë” ê°„ë‹¨í•˜ê³  íš¨ìœ¨ì ì…ë‹ˆë‹¤.

```js
// App.js
import { useState, useEffect, useRef } from 'react';
import './welcome.css';

function Welcome() {
  return <h1 className='welcome'>Welcome</h1>;
}

export default function App() {
  const [show, setShow] = useState(false);
  return (
    <>
      <button onClick={() => setShow(!show)}>{show ? 'Remove' : 'Show'}</button>
      <hr />
      {show && <Welcome />}
    </>
  );
}
```

```js
// welcom.css
.welcome {
  color: white;
  padding: 50px;
  text-align: center;
  font-size: 50px;
  background-image: radial-gradient(circle, rgba(63, 94, 251, 1) 0%, rgba(252,70,107,1) 100%);

  animation: fadeIn 1000ms;
}

@keyframes fadeIn {
  0% { opacity: 0; }
  100% { opacity: 1; }
}
```

<br>

- ê¼­ `Hook`ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤!

<br>

## ìš”ì•½

- ì»¤ìŠ¤í…€ `Hook`ì„ ì‚¬ìš©í•˜ë©´ ì»´í¬ë„ŒíŠ¸ ê°„ì— ë¡œì§ì„ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook`ì€ `use`ë¡œ ì‹œì‘í•˜ê³  ë’¤ì— ëŒ€ë¬¸ìê°€ ì˜¤ëŠ” ì´ë¦„ì„ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- ì‚¬ìš©ì ì •ì˜ `Hook`ëŠ” ìƒíƒœ ìì²´ê°€ ì•„ë‹Œ ìƒíƒœ ë¡œì§ë§Œ ê³µìœ í•©ë‹ˆë‹¤.
- í•˜ë‚˜ì˜ `Hook`ì—ì„œ ë‹¤ë¥¸ `Hook`ë¡œ ë°˜ì‘ ê°’ì„ ì „ë‹¬í•  ìˆ˜ ìˆìœ¼ë©° ìµœì‹  ìƒíƒœë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
- ëª¨ë“  `Hook`ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ì‹œ ë Œë”ë§ë  ë•Œë§ˆë‹¤ ë‹¤ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- ì»¤ìŠ¤í…€ `Hook`ì˜ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ì½”ë“œì²˜ëŸ¼ ìˆœìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤.
- ì‚¬ìš©ì ì •ì˜ `Hook`ì—ì„œ ìˆ˜ì‹ í•œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ `Effect` ì´ë²¤íŠ¸ë¡œ ë˜í•‘í•©ë‹ˆë‹¤.
- `useMount`ì™€ ê°™ì€ ì»¤ìŠ¤í…€ `Hook`ì„ ë§Œë“¤ì§€ ë§ˆì‹­ì‹œì˜¤.
  - ëª©ì ì„ êµ¬ì²´ì ìœ¼ë¡œ ìœ ì§€í•˜ì‹­ì‹œì˜¤.
- ì½”ë“œì˜ ê²½ê³„ë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•ê³¼ ìœ„ì¹˜ëŠ” ì‚¬ìš©ìì—ê²Œ ë‹¬ë ¤ ìˆìŠµë‹ˆë‹¤.
